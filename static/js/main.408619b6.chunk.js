(this["webpackJsonphacker-news-app"]=this["webpackJsonphacker-news-app"]||[]).push([[0],{40:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var c,s=n(1),r=n(0),i=n.n(r),a=n(17),o=n.n(a),d=n(8),j=(n(40),n(3)),l=function(){return Object(s.jsxs)("header",{children:[Object(s.jsx)("h1",{children:"Hacker news app"}),Object(s.jsx)("nav",{children:Object(s.jsx)("ul",{children:Object(s.jsx)(d.c,{to:"/",activeClassName:"",children:"News List"})})})]})},u=function(e){var t=e.children;return Object(s.jsx)("section",{children:t})},b=n(7),h=n(12),O=n(16),f=n.n(O),x=n(26),m=n(27),p=n(14),k=n(33),w=n(34),v=new(function(){function e(t){Object(k.a)(this,e),this._url=t.baseUrl,this._headers=t.headers}return Object(w.a)(e,[{key:"_handleOriginalResponse",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getItemById",value:function(e){return fetch("".concat(this._url,"/v0/item/").concat(e,".json"),{method:"GET",headers:this._headers}).then(this._handleOriginalResponse)}},{key:"getNewStoriesIds",value:function(){return fetch("".concat(this._url,'/v0/newstories.json?print=pretty&orderBy="$key"&limitToFirst=').concat(100),{method:"GET",headers:this._headers}).then(this._handleOriginalResponse)}}]),e}())({baseUrl:"https://hacker-news.firebaseio.com",headers:{"Content-Type":"application/json"}}),g=Object(p.b)("news/fetchNews",Object(m.a)(f.a.mark((function e(){var t,n,c,s,r,i,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getNewStoriesIds();case 2:t=e.sent,n=t,c=[],s=Object(x.a)(n),e.prev=6,s.s();case 8:if((r=s.n()).done){e.next=16;break}return i=r.value,e.next=12,v.getItemById(i);case 12:a=e.sent,c.push(a);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),s.e(e.t0);case 21:return e.prev=21,s.f(),e.finish(21);case 24:return e.abrupt("return",c);case 25:case"end":return e.stop()}}),e,null,[[6,18,21,24]])})))),y=Object(p.b)("news/fetchRootComments",function(){var e=Object(m.a)(f.a.mark((function e(t){var n,c,s,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],c=Object(x.a)(t),e.prev=2,c.s();case 4:if((s=c.n()).done){e.next=12;break}return r=s.value,e.next=8,v.getItemById(r);case 8:i=e.sent,n.push(i);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),c.e(e.t0);case 17:return e.prev=17,c.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()),C=Object(p.c)({name:"news",initialState:{news:[],comments:[],status:"idle",statusRootComments:"idle",error:null,errorRootComments:null},reducers:{},extraReducers:(c={},Object(h.a)(c,g.pending,(function(e,t){e.status="loading"})),Object(h.a)(c,g.fulfilled,(function(e,t){e.status="succeeded",e.news=t.payload})),Object(h.a)(c,g.rejected,(function(e,t){e.status="failed",e.error=t.error.message})),Object(h.a)(c,y.pending,(function(e,t){e.statusRootComments="loading"})),Object(h.a)(c,y.fulfilled,(function(e,t){e.statusRootComments="succeeded",e.comments=t.payload})),Object(h.a)(c,y.rejected,(function(e,t){e.statusRootComments="failed",e.errorRootComments=t.error.message})),c)}),I=C.reducer,R=(C.actions.clearComments,function(e){return e.news.news}),B=function(e){return e.news.status},_=function(e){return e.news.error},E=function(e){return e.news.comments},N=function(e){return e.news.statusRootComments},S=function(e){return e.news.errorRootComments},T=function(e){return new Date(1e3*e).toLocaleString("en-us",{hour12:!1})},L=function(e){var t=e.data;return Object(s.jsxs)("article",{children:[Object(s.jsx)("header",{children:Object(s.jsx)("h3",{children:t.title})}),Object(s.jsxs)("p",{children:["The story's score: ",t.score]}),Object(s.jsxs)("footer",{children:[Object(s.jsxs)("address",{children:["By: ",t.by]}),Object(s.jsxs)("p",{children:["Date: ",Object(s.jsx)("time",{children:T(t.time)})]})]}),Object(s.jsx)(d.b,{to:"/news/".concat(t.id),children:"Go to this news"})]})},A=function(){var e,t=Object(b.b)(),n=Object(b.c)(R),c=Object(b.c)(B),r=Object(b.c)(_);return i.a.useEffect((function(){var e=setTimeout((function(){t(g())}),6e4);return"idle"===c&&t(g()),function(){clearTimeout(e)}}),[c,t]),"loading"===c||"succeeded"===c?e=n.map((function(e){return Object(s.jsx)("li",{id:e.id,children:Object(s.jsx)(L,{data:e})},e.id)})):"failed"===c&&(e=Object(s.jsx)("p",{children:r})),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("button",{disabled:"loading"===c,onClick:function(){t(g())},children:"loading"===c?"Loading...":"Update News"}),Object(s.jsxs)("h2",{children:["News list ","loading"===c&&Object(s.jsx)("span",{children:"(loading...)"})]}),Object(s.jsx)("ol",{children:e})]})},D=function(){return Object(s.jsx)("main",{children:Object(s.jsx)(u,{children:Object(s.jsx)(A,{})})})},F=n(11),G=n(19),U=n.n(G),H=new(0,n(59).AllHtmlEntities),M=function(e){return H.decode(e)},J=function(e){var t=e.id,n=i.a.useState(null),c=Object(F.a)(n,2),r=c[0],a=c[1],o=i.a.useState({}),d=Object(F.a)(o,2),j=d[0],l=d[1];i.a.useEffect((function(){v.getItemById(t).then((function(e){e.text=M(e.text),l(e)}),(function(e){console.log(e)}))}),[t]);return j.deleted?Object(s.jsx)("li",{children:"Comment has been deleted"},j.id):Object(s.jsxs)("li",{onClick:j.kids&&function(){a(Object(s.jsx)(P,{commentsIds:j.kids}))},children:[j.kids&&Object(s.jsxs)("p",{children:[j.kids.length," nested comment('s)"]}),Object(s.jsxs)("address",{children:["by: ",j.by]}),Object(s.jsxs)("p",{children:["Date: ",Object(s.jsx)("time",{children:T(j.time)})]}),Object(s.jsx)("h4",{children:"Comment text:"}),U()(M(j.text)),r]})},P=function(e){var t=e.commentsIds,n=i.a.useState(null),c=Object(F.a)(n,2),r=c[0],a=c[1];return i.a.useEffect((function(){var e=t.map((function(e){return Object(s.jsx)(J,{id:e},e)}));a(e)}),[t]),Object(s.jsx)("ul",{children:r})},W=function(e){var t=e.data,n=i.a.useState(null),c=Object(F.a)(n,2),r=c[0],a=c[1],o=i.a.useState({}),d=Object(F.a)(o,2),j=d[0],l=d[1];i.a.useEffect((function(){l(t)}),[t]);return Object(s.jsxs)("li",{onClick:j.kids&&function(){var e=Object(s.jsx)(P,{commentsIds:j.kids});a(e)},children:[j.kids&&Object(s.jsxs)("p",{children:[j.kids.length," nested comment('s)"]}),Object(s.jsxs)("address",{children:["by: ",j.by]}),Object(s.jsxs)("p",{children:["Date: ",Object(s.jsx)("time",{children:T(j.time)})]}),Object(s.jsx)("h4",{children:"Comment text:"}),U()(M(j.text)),j.kids&&r]})},$=function(e){var t=e.children;return Object(s.jsx)("ul",{children:t})},q=function(e){var t,n=e.match,c=Object(b.b)(),r=Object(b.c)(E),a=Object(b.c)(N),o=Object(b.c)(S),j=n.params.newsId,l=Object(b.c)((function(e){return function(e,t){return e.news.news.find((function(e){return e.id===Number(t)}))}(e,j)}));i.a.useEffect((function(){c(y(l.kids))}),[c,l]),i.a.useEffect((function(){var e=setTimeout((function(){c(y(l.kids))}),6e4);return"idle"===a&&c(y(l.kids)),function(){clearTimeout(e)}}),[c,a,l.kids]),"loading"===a?t=Object(s.jsx)("p",{children:"Loading..."}):"succeeded"===a?t=r.map((function(e){return e.deleted?Object(s.jsx)("li",{children:"Comment has been deleted"},e.id):Object(s.jsx)(W,{data:e},e.id)})):"failed"===a&&(t=Object(s.jsx)("p",{children:o}));return l?Object(s.jsx)(u,{children:Object(s.jsxs)("article",{children:[Object(s.jsx)("a",{href:l.url,target:"_blank",rel:"noreferrer",children:"Link to news"}),Object(s.jsx)("h3",{children:l.title}),Object(s.jsxs)("p",{children:["Date: ",T(l.time)]}),Object(s.jsxs)("p",{children:["By: ",l.by]}),Object(s.jsxs)("p",{children:[l.kids?l.descendants:"0"," comment('s)"]}),Object(s.jsx)("button",{type:"button",onClick:function(){l.kids&&c(y(l.kids))},disabled:"loading"===a,children:"loading"===a?"Loading...":"Update comments"}),l.kids&&Object(s.jsx)($,{children:t}),Object(s.jsx)(d.b,{to:"/",children:"Back to news list"})]})}):Object(s.jsxs)("section",{children:[Object(s.jsx)("h2",{children:"News not found!"}),Object(s.jsx)(d.b,{to:"/",children:"Back to news list"})]})},z=function(){return Object(s.jsxs)("footer",{children:[Object(s.jsx)("address",{children:"Author: Melnikov Aleksei"}),Object(s.jsxs)("nav",{children:[Object(s.jsx)("h3",{children:"Contacts:"}),Object(s.jsxs)("ul",{children:[Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:"https://github.com/MelnikovAleksei",target:"_blank",rel:"noreferrer",children:"GitHub"})}),Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:"https://www.facebook.com/meln.aleksei",target:"_blank",rel:"noreferrer",children:"Facebook"})})]})]})]})},K=function(){return Object(s.jsxs)("main",{children:[Object(s.jsx)("h3",{children:"404 Page not found"}),Object(s.jsx)(d.b,{to:"/",children:"Back to news list"})]})};var Q=function(){return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsx)(l,{}),Object(s.jsxs)(j.c,{children:[Object(s.jsx)(j.a,{exact:!0,path:"/",render:function(){return Object(s.jsx)(i.a.Fragment,{children:Object(s.jsx)(D,{})})}}),Object(s.jsx)(j.a,{exact:!0,path:"/news/:newsId",component:q}),Object(s.jsx)(j.a,{path:"*",children:Object(s.jsx)(K,{})})]}),Object(s.jsx)(z,{})]})},V=Object(p.a)({reducer:{news:I}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(b.a,{store:V,children:Object(s.jsx)(d.a,{children:Object(s.jsx)(Q,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[63,1,2]]]);
//# sourceMappingURL=main.408619b6.chunk.js.map